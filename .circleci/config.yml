version: '2.1'
orbs:
  cloudfoundry: circleci/cloudfoundry@1.0.0
workflows:
  build-deploy:
    jobs:
      - cloudfoundry/push:
          appname: exchange-value
          build_steps:
            - run: sudo apt-get update
            - run: sudo apt-get install -y ca-certificates jq
            - run: curl -v -L -o cf-cli_amd64.deb 'https://cli.run.pivotal.io/stable?release=debian64&source=github'
            - run: sudo dpkg -i cf-cli_amd64.deb
            - run: cf -v
            - run: cf api "$CF_API"
            - run: cf auth "$CF_USER" "$CF_PASSWORD"
            - run: cf push exchange-value
          org: sampleOrg
          space: dev